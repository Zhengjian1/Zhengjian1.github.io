(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"67Et":function(e,t,a){e.exports={allCheck:"antd-pro-pages-scene-collection-create-form-allCheck",packName:"antd-pro-pages-scene-collection-create-form-packName"}},PBNW:function(e,t,a){e.exports={cardList:"antd-pro-pages-scene-scenelist-cardList",card:"antd-pro-pages-scene-scenelist-card",item:"antd-pro-pages-scene-scenelist-item",extraImg:"antd-pro-pages-scene-scenelist-extraImg",newButton:"antd-pro-pages-scene-scenelist-newButton",cardAvatar:"antd-pro-pages-scene-scenelist-cardAvatar",cardDescription:"antd-pro-pages-scene-scenelist-cardDescription",pageHeaderContent:"antd-pro-pages-scene-scenelist-pageHeaderContent",contentLink:"antd-pro-pages-scene-scenelist-contentLink",tableListForm:"antd-pro-pages-scene-scenelist-tableListForm",submitButtons:"antd-pro-pages-scene-scenelist-submitButtons"}},oeId:function(e,t,a){"use strict";a.r(t);a("Mwp2");var n,c,s,r,l,i,o,d,m,u,p=a("VXEj"),h=(a("IzEo"),a("bx4M")),f=a("gWZ8"),v=a.n(f),E=(a("2qtc"),a("kLXV")),y=(a("Pwec"),a("CtXQ")),g=(a("14J3"),a("BMrR")),N=(a("+L6B"),a("2/Rp")),k=(a("jCWc"),a("kPKH")),b=(a("5NDa"),a("5rEg")),C=a("p0pE"),S=a.n(C),w=a("2Taf"),D=a.n(w),M=a("vZ4D"),V=a.n(M),B=a("l4Ni"),F=a.n(B),L=a("ujKo"),R=a.n(L),I=a("MhPg"),x=a.n(I),A=(a("y8nQ"),a("Vl3Y")),P=a("q1tI"),O=a.n(P),W=a("MuoO"),j=a("zHco"),J=a("67Et"),q=a.n(J),H=(n=A["a"].create(),n((s=function(e){function t(){var e,a;D()(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return a=F()(this,(e=R()(t)).call.apply(e,[this].concat(c))),a.onBlur=function(e){var t=a.props.checkSceneName;t(e.target.value)},a}return x()(t,e),V()(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,c=e.form,s=e.data,r=e.isEdit,l=e.duplicateName,i=c.getFieldDecorator;return t?O.a.createElement(E["a"],{visible:t,title:r?"\u7f16\u8f91\u573a\u666f":"\u6dfb\u52a0\u573a\u666f",onCancel:a,maskClosable:!1,onOk:function(){return n()}},O.a.createElement(A["a"],{layout:"vertical"},O.a.createElement(A["a"].Item,{label:"\u573a\u666f\u540d\u5b57"},i("sceneName",{initialValue:s&&s.sceneName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u573a\u666f\u540d\u5b57"}]})(O.a.createElement(b["a"],{onChange:this.onBlur,onBlur:this.onBlur,allowClear:!0})),l?O.a.createElement("span",{className:q.a.packName},"\u573a\u666f\u540d\u91cd\u590d"):""),O.a.createElement(A["a"].Item,{label:"\u573a\u666f\u63cf\u8ff0"},i("sceneDesc",{initialValue:s&&s.sceneDesc,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u573a\u666f\u63cf\u8ff0"}]})(O.a.createElement(b["a"].TextArea,{type:"textarea"}))))):""}}]),t}(P["Component"]),c=s))||c),K=H,T=(r=Object(W["connect"])(function(e){var t=e.scene;return{scene:t}}),r((i=function(e){function t(){var e,a;D()(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return a=F()(this,(e=R()(t)).call.apply(e,[this].concat(c))),a.state={visible:!1,data:{},isEdit:!1,duplicateName:!1},a.showModal=function(e,t){var n=!1,c={};"edit"===t&&(n=!0,c=e),a.setState({visible:!0,isEdit:n,data:c})},a.handleCancel=function(){a.setState({visible:!1,data:{},duplicateName:!1})},a.handleCreate=function(){var e=a.formRef.props.form,t=a.state,n=t.data,c=t.isEdit,s=a.props.dispatch;e.validateFields(function(t,r){t||a.checkSceneName(r.sceneName)||(s(c?{type:"scene/updateScene",payload:{id:n.id,sceneName:r.sceneName,sceneDesc:r.sceneDesc}}:{type:"scene/addScene",payload:{sceneName:r.sceneName,sceneDesc:r.sceneDesc}}),e.resetFields(),a.setState({visible:!1}))})},a.saveFormRef=function(e){a.formRef=e},a.checkSceneName=function(e){var t=a.props.list,n=JSON.parse(JSON.stringify(t)),c=a.state.data,s=!1;return n.forEach(function(t){t.sceneName!==c.sceneName&&t.sceneName===e&&(s=!0)}),a.setState({duplicateName:s}),s},a}return x()(t,e),V()(t,[{key:"componentDidMount",value:function(){var e=this.props.onRef;e(this)}},{key:"render",value:function(){var e=this.state,t=e.visible,a=e.data,n=e.isEdit,c=e.duplicateName,s=this.props.list;return O.a.createElement("div",null,O.a.createElement(K,{wrappedComponentRef:this.saveFormRef,visible:t,onCancel:this.handleCancel,onCreate:this.handleCreate,data:a,list:s,isEdit:n,duplicateName:c,checkSceneName:this.checkSceneName}))}}]),t}(P["Component"]),l=i))||l),X=T,z=a("PBNW"),Q=a.n(z),Z=A["a"].Item,Y=(o=Object(W["connect"])(function(e){var t=e.scene,a=e.loading;return{scene:t,loading:a.models.list}}),d=A["a"].create(),o(m=d((u=function(e){function t(){var e,a;D()(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return a=F()(this,(e=R()(t)).call.apply(e,[this].concat(c))),a.state={modal2Visible:!1,id:"",formValues:{}},a.handleAdd=function(){a.child.showModal()},a.handleEdit=function(e){a.child.showModal(e,"edit")},a.handleLinkMenu=function(e){var t=a.props.history;t.push({pathname:"/scene/scene-list/rule/".concat(e.id),search:"?title=".concat(e.sceneName)})},a.handleDel=function(e){a.setModal2Visible(!0,e.id)},a.deleteWorkPack=function(e){var t=a.props.dispatch;t({type:"scene/deleteScene",payload:{id:e,onClose:function(){return a.setModal2Visible(!1)}}})},a.handleSearch=function(e){e.preventDefault();var t=a.props,n=t.dispatch,c=t.form;c.validateFields(function(e,t){if(!e){var c=S()({},t);a.setState({formValues:c}),n({type:"scene/seachScene",payload:c})}})},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"scene/seachScene",payload:{}})},a.onRef=function(e){a.child=e},a.setModal2Visible=function(e,t){a.setState({modal2Visible:e,id:t})},a}return x()(t,e),V()(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"scene/fetch",payload:{}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.scene.list,n=t.loading,c=t.form.getFieldDecorator,s=this.state,r=s.modal2Visible,l=s.id,i=O.a.createElement(A["a"],{onSubmit:this.handleSearch,layout:"inline"},O.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},O.a.createElement(k["a"],{md:8,sm:24},O.a.createElement(Z,{label:"\u573a\u666f",style:{width:"100%"}},c("value")(O.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),O.a.createElement(k["a"],{md:8,sm:24},O.a.createElement("span",{className:Q.a.submitButtons},O.a.createElement(N["a"],{type:"primary",htmlType:"submit"},"\u641c\u7d22"),O.a.createElement(N["a"],{style:{marginLeft:8},onClick:this.handleFormReset},"\u6e05\u7a7a"))))),o=function(t){return[O.a.createElement("a",{onClick:function(){return e.handleDel(t)}},O.a.createElement(y["a"],{type:"delete"}),"\xa0\u5220\u9664"),O.a.createElement("a",{onClick:function(){return e.handleEdit(t)}},O.a.createElement(y["a"],{type:"edit"}),"\xa0\u7f16\u8f91"),O.a.createElement("a",{onClick:function(){return e.handleLinkMenu(t)}},O.a.createElement(y["a"],{type:"menu-unfold"}),"\xa0\u5217\u8868")]};return O.a.createElement(j["a"],{title:"\u7ba1\u7406\u573a\u666f\u4f7f\u7528\u89c4\u5219"},O.a.createElement(E["a"],{title:"\u63d0\u793a",centered:!0,visible:r,onOk:function(){return e.deleteWorkPack(l)},onCancel:function(){return e.setModal2Visible(!1)}},O.a.createElement("p",null,"\u786e\u8ba4\u5220\u9664\u8be5\u573a\u666f\u5417\uff1f")),O.a.createElement(X,{onRef:this.onRef,list:a}),O.a.createElement("div",{className:Q.a.tableListForm},i),O.a.createElement("div",{className:Q.a.cardList},O.a.createElement(p["a"],{rowKey:"id",loading:n,grid:{gutter:24,lg:4,md:2,sm:1,xs:1},dataSource:[""].concat(v()(a)),renderItem:function(t){return t?O.a.createElement(p["a"].Item,{key:t.id},O.a.createElement(h["a"],{hoverable:!0,className:Q.a.card,title:O.a.createElement("a",null,t.sceneName),actions:o(t)},O.a.createElement("div",null,t.sceneDesc),O.a.createElement("div",null,t.creator))):O.a.createElement(p["a"].Item,{onClick:e.handleAdd},O.a.createElement(N["a"],{type:"dashed",className:Q.a.newButton},O.a.createElement(y["a"],{type:"plus"})," \u65b0\u5efa\u573a\u666f"))}})))}}]),t}(P["PureComponent"]),m=u))||m)||m);t["default"]=Y}}]);